
<head>
<meta charset='utf-8' />
<title>Show polygon information on click</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.css' rel='stylesheet' />
<style>
body { margin:0; padding:0; }
#map { position:absolute; top:0; bottom:0; width:100%; }
</style>
</head>

<body>
<h2>Index</h2>
<div id="map" style="height:500px"></div>
<div id='geocoder' class='geocoder'></div>
 
<script>
 const TOKEN = "pk.eyJ1Ijoia2FzYWx1b3FpIiwiYSI6ImNqbHZ2OW53bTB5aHozcW9kcDJibndycXUifQ.SeWM7HbI0owT-Rwuv14Ntg";

mapboxgl.accessToken = TOKEN;
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/light-v9',
    //style: 'mapbox://styles/mapbox/light-v9',
    center: [145.045837, -37.876823],
    zoom: 13
});
 
var hoveredStateId = null;

 
function getRandomColor() {
    var letters = '0123456789ABCDEF';
    var color = '#';
    for (var i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
    }
    return color;
}
 
map.on('load', function () {
    // Add a layer showing the places.

    map.addSource("states", {
        "type": "geojson",
        "data": "https://raw.githubusercontent.com/kasaluoqi/root/master/VIC.geojson"
    });

    map.addLayer({
        "id": "state-fills",
        "type": "fill",
        "source": "states",
        "layout": {},
        "paint": {
            "fill-color": {
                property: 'lga_pid',
                type: 'categorical',
                stops: [
                    ['VIC245', '#F2F12D'],
                    ['VIC246', '#723122'],
                    ['VIC221', '#A25626'],
                    ['4', '#DA9C20'],
                    ['5', '#CA8323'],
                    ['6', '#B86B25'],
                    ['7', '#A25626'],
                    ['8', '#8B4225'],
                    ['9', '#723122']
                ]
            },
            "fill-opacity": ["case",
                ["boolean", ["feature-state", "hover"], false],
                1,
                0.5
            ]
            

        }
    });

    map.addLayer({
        "id": "state-borders",
        "type": "line",
        "source": "states",
        "layout": {},
        "paint": {
            "line-color": "#627BC1",
            "line-width": 2
        }
    });



    map.on('click', 'state-fills', function (e) {
        
        var lga_pid = e.features[0].properties.lga_pid;
        var name = e.features[0].properties.vic_lga__3;
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML("lga_pid: "+ lga_pid + ", Name: " + name)
            .addTo(map);
    });


    // When the user moves their mouse over the state-fill layer, we'll update the
    // feature state for the feature under the mouse.
    map.on("mousemove", "state-fills", function (e) {
        if (e.features.length > 0) {
            if (hoveredStateId) {
                map.setFeatureState({ source: 'states', id: hoveredStateId }, { hover: false });
            }
            hoveredStateId = e.features[0].id;
            map.setFeatureState({ source: 'states', id: hoveredStateId }, { hover: true });
        }
    });

    // When the mouse leaves the state-fill layer, update the feature state of the
    // previously hovered feature.
    map.on("mouseleave", "state-fills", function () {
        if (hoveredStateId) {
            map.setFeatureState({ source: 'states', id: hoveredStateId }, { hover: false });
        }
        hoveredStateId = null;
    });

});
 
</script>

</body>
